(this.webpackJsonphadi=this.webpackJsonphadi||[]).push([[0],{14:function(e,t,n){},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var c=n(1),i=n(0),r=n.n(i),a=n(7),d=n.n(a),u=(n(14),n(2)),o=n.n(u),l=n(5),s=n(3),h=n(6),f=n(8);n(16);function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if("revalidate"===t.type){var n=t.payload.buttons;if(!n)return e;var c=n.map((function(t){var n=e.find((function(e){return e.id===t.id})),c=t;return c.checked=(null===n||void 0===n?void 0:n.checked)||"loading",c}));return c}if(["check","check_fail","loading"].includes(t.type)){var i=t.payload,r=i.id,a=i.checked,d=void 0!==a&&a,u=e.find((function(e){return e.id===r}));if(!u)return e;var o=e.map((function(e){return e.id===r?Object(h.a)(Object(h.a)({},e),{},{checked:"loading"===t.type?"loading":d,checked_old:u.checked}):e}));return o}return e}var v=function(){var e=Object(i.useState)(!1),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)(!1),d=Object(s.a)(a,2),u=d[0],h=d[1],v=Object(i.useReducer)(p,[]),j=Object(s.a)(v,2),b=j[0],k=j[1],O=Object(f.a)("home",(function(){return fetch("http://192.168.43.67/api/get_devices").then((function(e){return e.json()}))}),{revalidateOnFocus:!1}),g=O.data,x=O.error,y=O.isValidating;Object(i.useEffect)((function(){var e;h(!1),(null===g||void 0===g||null===(e=g.swith)||void 0===e?void 0:e.length)&&k({type:"revalidate",payload:{buttons:g.swith}})}),[g]),Object(i.useEffect)((function(){!n&&b.length&&(b.map((function(e){return m(e.id)})),r(!0))}),[b]);var m=function(){var e=Object(l.a)(o.a.mark((function e(t){var n,c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h(!1),n=null===b||void 0===b?void 0:b.find((function(e){return e.id===t}))){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,k({type:"loading",payload:{id:t}}),e.next=8,fetch(n.check);case 8:return c=e.sent,e.next=11,c.json();case 11:i=e.sent,k({type:"check",payload:{id:t,checked:i.checked}}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),k({type:"check_fail",payload:{id:t}}),h(!0);case 19:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!1),e.prev=1,e.next=4,fetch(t.control_url);case 4:e.sent,k({type:"check",payload:{id:t.id,checked:!t.checked}}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),h(!0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(c.jsx)("div",{className:"App",children:Object(c.jsxs)("div",{className:"App-header",children:[(null===b||void 0===b?void 0:b.length)?Object(c.jsx)("ul",{className:"list",children:b.map((function(e){return Object(c.jsxs)("li",{onClick:function(){return w(e)},children:[e.title," - ","loading"===e.checked?"loading...":e.checked?"On":"Off"]},e.id)}))}):Object(c.jsx)("div",{}),x&&Object(c.jsx)("div",{children:"failed to load"}),u&&Object(c.jsx)("div",{children:"transaction failed!"}),y&&Object(c.jsx)("div",{children:"loading..."})]})})},j=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),i(e),r(e),a(e)}))};d.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(v,{})}),document.getElementById("root")),j()}},[[17,1,2]]]);
//# sourceMappingURL=main.js.map